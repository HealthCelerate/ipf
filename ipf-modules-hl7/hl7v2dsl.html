
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-03-09
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>HL7v2 Domain Specific Language | ipf-modules-hl7</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/github.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
	</head>

	<body class="page-hl7v2dsl project-ipf-modules-hl7" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href=".."><span class="color-highlight">IPF</span> Open eHealth Integration Platform</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a></li>
							<li ><a href="https://github.com/oehf/ipf" title="GitHub project" class="externalLink">GitHub project</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a></li>
									<li ><a href="index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a></li>
									<li ><a href="../ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a></li>
									<li ><a href="../ipf-modules-cda/index.html" title="CDA Support">CDA Support</a></li>
									<li ><a href="../ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a></li>
									<li ><a href="../ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a></li>
									<li ><a href="../ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a></li>
									<li ><a href="../ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a></li>
									<li ><a href="../dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a></li>
									<li ><a href="../ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a></li>
									<li ><a href="../ipf-tutorials/index.html" title="Tutorials">Tutorials</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="../" id="bannerLeft"><h1><br/><span class="color-highlight">IPF</span> Open eHealth Integration Platform</h1></a>
					<p class="lead">eHealth standards on steroids</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="HL7v2_Domain_Specific_Language">HL7v2 Domain Specific Language</h2>
 </div> 
 <p>The <a class="externalLink" href="https://www.groovy-lang.org">Groovy</a>-based HL7v2 DSL provides a unique programming interface for handling HL7v2 messages. Its API aligns very closely with natural language and the syntax of HL7v2 as often seen in specifications and requirements, so that translation from the language of the “HL7 world” into the language of the “developer’s world” becomes redundant.</p> 
 <div class="section"> 
  <h3 id="How_it_works">How it works</h3> 
  <p>The &acute;ipf-modules-hl7` library is basically a <a class="externalLink" href="https://www.groovy-lang.org/metaprogramming.html#_extension_modules">Groovy extension module</a> that adds the required methods to the <a class="externalLink" href="http://hl7api.sourceforge.net">HAPI</a> model classes. These methods are used “under the hood” by the actual DSL.</p> 
  <p><b>Note</b>: IPF 2.x used a dedicated <tt>ipf-modules-hl7dsl</tt> library and achieved the same goal by using adapters wrapped around the <a class="externalLink" href="http://hl7api.sourceforge.net">HAPI</a> model classes. With IPF 3, this library and all wrappers have been deprecated, and we strongly recommend to migrate your applications.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Accessing_HL7_messages">Accessing HL7 messages</h3> 
  <p>The DSL offers a position-based navigation of HL7 structures and fields. It’s all valid Groovy Syntax, accomplished by operator overloading and metaclass programming, so you don’t need a intermediate step that parses the expressions (see the <a class="externalLink" href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/util/Terser.html">Terser</a> class in HAPI).</p> 
  <div class="section"> 
   <h4 id="Accessing_groups_and_segments">Accessing groups and segments</h4> 
   <p>Groups and segments can be accessed by name like an object property.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>    import ca.uhn.hl7v2.model.Message

    Message message = ...
    def msh   = message.MSH
    def group = message.PATIENT_RESULT
    def pid   = message.PATIENT_RESULT.PATIENT.PID
</pre> 
    </div> 
   </div> 
   <p>Details are described <a href="hl7v2dslStructures.html">here</a>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="Accessing_fields_and_field_values">Accessing fields and field values</h4> 
   <p>Obtaining fields is similar to obtaining groups and segments except that fields are often referred to by number instead of by name. Fields are accessed like an array field. Components in a composite field are accessed like a two-dimensional array. Subcomponents are accessed like a three-dimensional array.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>    String messageType = message.MSH[9][1].value
    String street = message.PATIENT_RESULT.PATIENT.PID[11][1][1].value
</pre> 
    </div> 
   </div> 
   <p>Details are described <a href="hl7v2dslFields.html">here</a>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="Repetitions">Repetitions</h4> 
   <p>Groups, segments and fields may be repeatable. Parentheses like with regular method calls are used in order to obtain a certain element of a repeating structure.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>    def group = message.PATIENT_RESULT(0).PATIENT
    def nk1   = group.NK1(1)
</pre> 
    </div> 
   </div> 
   <p>Details are described <a href="hl7v2dslRepetitions.html">here</a>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="Smart_navigation">Smart navigation</h4> 
   <p>Accessing HL7 messages as described above usually requires knowledge about the specified message structure, which is often not visible by looking at the printed message. To make things worse, the internal structure changes between HL7 versions. In more recent versions, primitive types are sometimes replaced with composite types having the so far used primitive as first component. This appears to be backwards compatible on printed messages, but requires different DSL expressions when obtaining field values.</p> 
   <p>Smart navigation resolves these problems by assuming reasonable defaults when repetitions or component operators are omitted</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>    assert group.NK1(0)[2][1][1].value == group.NK1[2].value
</pre> 
    </div> 
   </div> 
   <p>Details are described <a href="hl7v2dslSmartNavigation.html">here</a>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="Iterative_functions">Iterative functions</h4> 
   <p>As HL7 messages are compound structures, it should be possible to traverse them. Thus, the HL7 DSL implements iterators for HL7 messages and groups. Due to their nested structures, iteration is implemented as a depth first traversal over all non-empty substructures, i.e. non-empty groups and segments.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>    import ca.uhn.hl7v2.model.Message

    boolean hasGroups = message.any { it instanceof Group }
    def allStructureNames = message*.name
</pre> 
    </div> 
   </div> 
   <p>Details are described <a href="hl7v2dslIteration.html">here</a>.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Creating_HL7_messages_and_their_internal_structures">Creating HL7 messages (and their internal structures)</h3> 
  <p>New messages can be created from scratch by just specifying HL7 event type, trigger event and version, i.e. it is not required to know about the object type to be instantiated. The message header fields are populated with the event type, trigger event, version, the current time as message date, and the common separators.</p> 
  <p>Just as creating a message, segments and fields can be created without actually knowing their respective type.</p> 
  <p>Details are described <a href="hl7v2dslCreation.html">here</a>.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Manipulating_HL7_messages">Manipulating HL7 messages</h3> 
  <p>Message manipulation is as straightforward as read access. You navigate to a segment or field and assign it a new object or String value.</p> 
  <p>Details are described <a href="hl7v2dslManipulation.html">here</a>.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Parsing_and_Rendering_HL7_messages">Parsing and Rendering HL7 messages</h3> 
  <p>IPF does not change or extend the <a class="externalLink" href="http://hl7api.sourceforge.net">HAPI</a> on how to parse or render HL7 message.</p> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#HL7v2_Domain_Specific_Language" title="HL7v2 Domain Specific Language">HL7v2 Domain Specific Language <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#How_it_works" title="How it works">How it works</a>
		<li class="dropdown"><a href="#Accessing_HL7_messages" title="Accessing HL7 messages">Accessing HL7 messages <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Accessing_groups_and_segments" title="Accessing groups and segments">Accessing groups and segments</a>
		<li><a href="#Accessing_fields_and_field_values" title="Accessing fields and field values">Accessing fields and field values</a>
		<li><a href="#Repetitions" title="Repetitions">Repetitions</a>
		<li><a href="#Smart_navigation" title="Smart navigation">Smart navigation</a>
		<li><a href="#Iterative_functions" title="Iterative functions">Iterative functions</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#Creating_HL7_messages_and_their_internal_structures" title="Creating HL7 messages (and their internal structures)">Creating HL7 messages (and their internal structures)</a>
		<li><a href="#Manipulating_HL7_messages" title="Manipulating HL7 messages">Manipulating HL7 messages</a>
		<li><a href="#Parsing_and_Rendering_HL7_messages" title="Parsing and Rendering HL7 messages">Parsing and Rendering HL7 messages</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="../" title="Home">Home</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="GitHub project" class="externalLink">GitHub project</a>
						</li>
						<li >
							<a href="../changes-report.html" title="Release notes">Release notes</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Download</li>
						<li >
							<a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a>
						</li>
						<li >
							<a href="../license.html" title="License">License</a>
						</li>
						<li class="nav-header">Development</li>
						<li >
							<a href="../development.html" title="Development">Development</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/issues/" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li class="nav-header">Submodules</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li >
							<a href="../ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a>
						</li>
						<li >
							<a href="index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a>
						</li>
						<li >
							<a href="../ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a>
						</li>
						<li >
							<a href="../ipf-modules-cda/index.html" title="CDA Support">CDA Support</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a>
						</li>
						<li >
							<a href="../ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a>
						</li>
						<li >
							<a href="../dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a>
						</li>
						<li >
							<a href="../ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a>
						</li>
						<li >
							<a href="../ipf-tutorials/index.html" title="Tutorials">Tutorials</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven Reports</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li >
							<a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017 <a href="http://www.openehealth.org/">Open eHealth Foundation</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 3.2-SNAPSHOT. </span><span class="publishDate">Last Published: 2017-03-09. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>
