
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-03-09
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Handling of data types and exceptions in MLLP-based IPF IHE components | ipf-platform-camel-ihe-mllp</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/github.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
	</head>

	<body class="page-messagetypes project-ipf-platform-camel-ihe-mllp" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href=".."><span class="color-highlight">IPF</span> Open eHealth Integration Platform</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a></li>
							<li ><a href="https://github.com/oehf/ipf" title="GitHub project" class="externalLink">GitHub project</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a></li>
									<li ><a href="../ipf-modules-hl7/index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a></li>
									<li ><a href="../ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a></li>
									<li ><a href="../ipf-modules-cda/index.html" title="CDA Support">CDA Support</a></li>
									<li ><a href="../ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a></li>
									<li ><a href="../ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a></li>
									<li ><a href="../ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a></li>
									<li ><a href="../ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a></li>
									<li ><a href="../dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a></li>
									<li ><a href="../ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a></li>
									<li ><a href="../ipf-tutorials/index.html" title="Tutorials">Tutorials</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="../" id="bannerLeft"><h1><br/><span class="color-highlight">IPF</span> Open eHealth Integration Platform</h1></a>
					<p class="lead">eHealth standards on steroids</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="Handling_of_data_types_and_exceptions_in_MLLP-based_IPF_IHE_components">Handling of data types and exceptions in MLLP-based IPF IHE components</h2>
 </div> 
 <p>The IHE Camel components provided by IPF accept and produced a fixed set of message types. These types differ depending on whether an endpoint acts as producer or consumer.</p> 
 <div class="section"> 
  <h3 id="Consumer-side_requests">Consumer-side requests</h3> 
  <p>Consumer-side requests are automatically unmarshalled, i.e. the incoming message stream sent by the client is transformed into a HAPI Message object. When unmarshalling fails, an HL7 NAK response will be automatically generated and passed back to the sender.</p> 
  <p>Unmarshalling may also fail already earlier during reception of the MLLP byte stream (particularly when invalid characters are encountered due to misconfigured character set). You have the following two possiblities to handle these kind of errors:</p> 
  <ul> 
   <li>add a parameter <tt>consumer.exceptionHandler=#myExceptionHandler</tt> where the configured exception handler must implement the interface <tt>org.apache.camel.spi.ExceptionHandler</tt>.</li> 
   <li>add a parameter <tt>consumer.bridgeErrorhandler=true</tt> which causes the exception handlers in the consumer route to be called</li> 
  </ul> 
  <p>In both cases, you should populate the message body with a proper HL7 NAK response to be returned to the sender.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Producer-side_responses">Producer-side responses</h3> 
  <p>Producer-side responses are automatically unmarshalled, i.e. the incoming message stream returned by the server is transformed into a HAPI Message object. When unmarshalling fails, an exception will be thrown.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Consumer-side_responses">Consumer-side responses</h3> 
  <p>Consumer-side responses are accepted in a number of data types that will be converted into a HL7 message stream to be returned to the client:</p> 
  <ul> 
   <li>HAPI <a class="externalLink" href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Message.html"><tt>ca.uhn.hl7v2.model.Message</tt></a></li> 
   <li><tt>String</tt></li> 
   <li><tt>byte[]</tt></li> 
   <li><tt>java.nio.ByteBuffer</tt></li> 
   <li><tt>java.io.InputStream</tt></li> 
   <li><tt>java.io.File</tt></li> 
   <li><a class="externalLink" href="https://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/component/file/GenericFile.html"><tt>org.apache.camel.component.file.GenericFile&lt;File&gt;</tt></a></li> 
   <li><a class="externalLink" href="https://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/WrappedFile.html"><tt>org.apache.camel.WrappedFile&lt;File&gt;</tt></a></li> 
  </ul> 
  <p>In addition, the message body can contain an <tt>Exception</tt> instance, which will be transformed into a NAK response. Any exceptions thrown in the route that are not handled otherwise will lead to NAK responses as well. When neither the data type of the response message is supported nor an exception has been thrown in the route, the message header <tt>org.openehealth.ipf.platform.camel.ihe.mllp.core.MllpComponent.ACK_TYPE_CODE_HEADER</tt> will be taken into consideration.</p> 
  <p>When the value of this header belongs to the enumeration type <a class="externalLink" href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/AcknowledgmentCode.html"><tt>ca.uhn.hl7v2.AcknowledgmentCode</tt></a>, an acknowledgement will be automatically generated and sent back to the client â€” a positive one for <tt>AcknowledgmentCode.AA</tt>, a negative one (NAK) for <tt>AcknowledgmentCode.AE</tt> and <tt>AcknowledgmentCode.AR</tt>.</p> 
  <p>When even this header is not set or when its value is not of desired type, the consumer route fails.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Producer-side_requests">Producer-side requests</h3> 
  <p>Producer-side requests are accepted in a number of data types that will be converted into a HL7 message stream to be sent to the server:</p> 
  <ul> 
   <li><tt>ca.uhn.hl7v2.model.Message</tt> (HAPI)</li> 
   <li><tt>String</tt></li> 
   <li><tt>byte[]</tt></li> 
   <li><tt>java.nio.ByteBuffer</tt></li> 
   <li><tt>java.io.InputStream</tt></li> 
   <li><tt>java.io.File</tt></li> 
   <li><tt>org.apache.camel.component.file.GenericFile&lt;File&gt;</tt></li> 
   <li><tt>org.apache.camel.WrappedFile&lt;File&gt;</tt></li> 
  </ul> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#Handling_of_data_types_and_exceptions_in_MLLP-based_IPF_IHE_components" title="Handling of data types and exceptions in MLLP-based IPF IHE components">Handling of data types and exceptions in MLLP-based IPF IHE components <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Consumer-side_requests" title="Consumer-side requests">Consumer-side requests</a>
		<li><a href="#Producer-side_responses" title="Producer-side responses">Producer-side responses</a>
		<li><a href="#Consumer-side_responses" title="Consumer-side responses">Consumer-side responses</a>
		<li><a href="#Producer-side_requests" title="Producer-side requests">Producer-side requests</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="../" title="Home">Home</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="GitHub project" class="externalLink">GitHub project</a>
						</li>
						<li >
							<a href="../changes-report.html" title="Release notes">Release notes</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Download</li>
						<li >
							<a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a>
						</li>
						<li >
							<a href="../license.html" title="License">License</a>
						</li>
						<li class="nav-header">Development</li>
						<li >
							<a href="../development.html" title="Development">Development</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/issues/" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li class="nav-header">Submodules</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li >
							<a href="../ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a>
						</li>
						<li >
							<a href="../ipf-modules-hl7/index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a>
						</li>
						<li >
							<a href="../ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a>
						</li>
						<li >
							<a href="../ipf-modules-cda/index.html" title="CDA Support">CDA Support</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a>
						</li>
						<li >
							<a href="../ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a>
						</li>
						<li >
							<a href="../dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a>
						</li>
						<li >
							<a href="../ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a>
						</li>
						<li >
							<a href="../ipf-tutorials/index.html" title="Tutorials">Tutorials</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven Reports</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li >
							<a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017 <a href="http://www.openehealth.org/">Open eHealth Foundation</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 3.2-SNAPSHOT. </span><span class="publishDate">Last Published: 2017-03-09. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>
