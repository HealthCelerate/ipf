
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-03-09
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>HL7 v2 unsolicited request message fragmentation in MLLP-based IPF IHE components | ipf-platform-camel-ihe-mllp</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/github.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
	</head>

	<body class="page-unsolicitedfragmentation project-ipf-platform-camel-ihe-mllp" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href=".."><span class="color-highlight">IPF</span> Open eHealth Integration Platform</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a></li>
							<li ><a href="https://github.com/oehf/ipf" title="GitHub project" class="externalLink">GitHub project</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a></li>
									<li ><a href="../ipf-modules-hl7/index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a></li>
									<li ><a href="../ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a></li>
									<li ><a href="../ipf-modules-cda/index.html" title="CDA Support">CDA Support</a></li>
									<li ><a href="../ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a></li>
									<li ><a href="../ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a></li>
									<li ><a href="../ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a></li>
									<li ><a href="../ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a></li>
									<li ><a href="../dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a></li>
									<li ><a href="../ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a></li>
									<li ><a href="../ipf-tutorials/index.html" title="Tutorials">Tutorials</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="../" id="bannerLeft"><h1><br/><span class="color-highlight">IPF</span> Open eHealth Integration Platform</h1></a>
					<p class="lead">eHealth standards on steroids</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="HL7_v2_unsolicited_request_message_fragmentation_in_MLLP-based_IPF_IHE_components">HL7 v2 unsolicited request message fragmentation in MLLP-based IPF IHE components</h2>
 </div> 
 <p>This feature corresponds to Section 2.10.2.2 (Segment fragmentation/continuation using the DSC segment) of the HL7 v2.5 specification, is supported on both producer and consumer sides, and controlled by the following endpoint URI parameters:</p> 
 <div class="section"> 
  <h3 id="Parameters">Parameters</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th align="left">Parameter name </th> 
     <th align="left">Type </th> 
     <th align="left">Default value </th> 
     <th align="left">Short description </th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td align="left"><tt>supportUnsolicitedFragmentation</tt> </td> 
     <td align="left">boolean </td> 
     <td align="left">false </td> 
     <td align="left">whether unsolicited message fragmentation should be supported by the given endpoint</td> 
    </tr> 
    <tr class="a"> 
     <td align="left"><tt>unsolicitedFragmentationThreshold</tt> </td> 
     <td align="left">int </td> 
     <td align="left">-1 </td> 
     <td align="left">threshold (maximal count of characters per segment) for segment fragmentation. Values smaller than 5 lead to no segment fragmentation.</td> 
    </tr> 
    <tr class="b"> 
     <td align="left"><tt>unsolicitedFragmentationStorage</tt> </td> 
     <td align="left">String </td> 
     <td align="left">n/a </td> 
     <td align="left">Spring bean name of a storage for fragment accumulators (relevant on consumer side only)</td> 
    </tr> 
   </tbody> 
  </table> 
  <p>As stated in the table above, support for unsolicited request message fragmentation can be activated by setting the URL parameter of the corresponding endpoint <tt>supportUnsolicitedFragmentation</tt> to <tt>true</tt>.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Behavior">Behavior</h3> 
  <p>On <i>producer</i> side, this will lead to automatic fragmentation of outgoing request messages based on the value of the URL parameter <tt>unsolicitedFragmentationThreshold</tt>, which denotes the maximal count of segments allowed in an outgoing message. This value should be greater than 2 in order to include at least one segment in addition to MSH and DSC. The producer will perform all necessary actions of the corresponding message exchange pattern to transport these fragments to the receiver, as depicted on the following interaction diagram:</p> 
  <p><img src="images/conti-producer-uf.png" alt="Producer Unsolicited Fragmentation" /></p> 
  <p>An MLLP-based IPF IHE consumer with enabled segment fragmentation support is able to automatically collect pieces of fragmented requests and put them into the route as a single cumulative request message:</p> 
  <p><img src="images/conti-consumer-uf.png" alt="Consumer Unsolicited Fragmentation" /></p> 
  <p>The <tt>MSH</tt> segment of the resulting request message is contained in the very first fragment, therefore the corresponding response will contain its message control ID from field <tt>MSH-10</tt> in its field <tt>MSA-2</tt>.</p> 
  <p>Consumers accumulate received fragments in special storages. The user should provide storage beans via consumer endpoint URIs, whereby the beans should correspond to the interface <a href="../apidocs/org/openehealth/ipf/platform/camel/ihe/mllp/core/UnsolicitedFragmentationStorage.html"><tt>org.openehealth.ipf.platform.camel.ihe.mllp.core.UnsolicitedFragmentationStorage</tt></a>. An Ehcache-based implementation is provided by IPF. </p> 
  <p>Here’s an example of how to configure it in the Spring context descriptor, supposed that “unsolicitedFragmentationCache” is defined in Ehcache configuration file:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>    &lt;bean id=&quot;ehcacheManager&quot; class=&quot;net.sf.ehcache.CacheManager&quot; factory-method=&quot;create&quot; /&gt;

    &lt;bean id=&quot;myUFStorage&quot;
          class=&quot;org.openehealth.ipf.platform.camel.ihe.mllp.core.EhcacheUnsolicitedFragmentationStorage&quot;&gt;
        &lt;constructor-arg index=&quot;0&quot;&gt;
            &lt;bean factory-bean=&quot;ehcacheManager&quot; factory-method=&quot;getCache&quot;&gt;
                &lt;constructor-arg value=&quot;unsolicitedFragmentationCache&quot; /&gt;
            &lt;/bean&gt;
        &lt;/constructor-arg&gt;
    &lt;/bean&gt;
</pre> 
   </div> 
  </div> 
  <p>The consumer endpoint URI can then contain the parameters <tt>&quot;&amp;supportUnsolicitedFragmentation=true&amp;unsolicitedFragmentationStorage=#myUFStorage&quot;</tt>. On both producer and consumer side, all unsolicited fragments or fragment requests (messages with filled <tt>MSH-14</tt> and <tt>DSC-1</tt>, respectively), which cannot be attributed to any active conversation, will be passed through unchanged to the route. Unsolicited fragmentation is not possible when the request message to be fragmented does already contain non-empty values in the fields <tt>MSH-14</tt> and/or <tt>DSC-1</tt>.</p> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#HL7_v2_unsolicited_request_message_fragmentation_in_MLLP-based_IPF_IHE_components" title="HL7 v2 unsolicited request message fragmentation in MLLP-based IPF IHE components">HL7 v2 unsolicited request message fragmentation in MLLP-based IPF IHE components <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Parameters" title="Parameters">Parameters</a>
		<li><a href="#Behavior" title="Behavior">Behavior</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="../" title="Home">Home</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="GitHub project" class="externalLink">GitHub project</a>
						</li>
						<li >
							<a href="../changes-report.html" title="Release notes">Release notes</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Download</li>
						<li >
							<a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a>
						</li>
						<li >
							<a href="../license.html" title="License">License</a>
						</li>
						<li class="nav-header">Development</li>
						<li >
							<a href="../development.html" title="Development">Development</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/issues/" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li class="nav-header">Submodules</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li >
							<a href="../ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a>
						</li>
						<li >
							<a href="../ipf-modules-hl7/index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a>
						</li>
						<li >
							<a href="../ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a>
						</li>
						<li >
							<a href="../ipf-modules-cda/index.html" title="CDA Support">CDA Support</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a>
						</li>
						<li >
							<a href="../ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a>
						</li>
						<li >
							<a href="../ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a>
						</li>
						<li >
							<a href="../dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a>
						</li>
						<li >
							<a href="../ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a>
						</li>
						<li >
							<a href="../ipf-tutorials/index.html" title="Tutorials">Tutorials</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven Reports</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li >
							<a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017 <a href="http://www.openehealth.org/">Open eHealth Foundation</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 3.2-SNAPSHOT. </span><span class="publishDate">Last Published: 2017-03-09. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>
