
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-03-09
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>IPF 3.2 Migration Guide | Reflow Maven Skin</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/github.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
	</head>

	<body class="page-migration-32 project-ipf" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="./"><span class="color-highlight">IPF</span> Open eHealth Integration Platform</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a></li>
							<li ><a href="https://github.com/oehf/ipf" title="GitHub project" class="externalLink">GitHub project</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a></li>
									<li ><a href="ipf-modules-hl7/index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a></li>
									<li ><a href="ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a></li>
									<li ><a href="ipf-modules-cda/index.html" title="CDA Support">CDA Support</a></li>
									<li ><a href="ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a></li>
									<li ><a href="ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a></li>
									<li ><a href="ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a></li>
									<li ><a href="ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a></li>
									<li ><a href="dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a></li>
									<li ><a href="ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a></li>
									<li ><a href="ipf-tutorials/index.html" title="Tutorials">Tutorials</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="./" id="bannerLeft"><h1><br/><span class="color-highlight">IPF</span> Open eHealth Integration Platform</h1></a>
					<p class="lead">eHealth standards on steroids</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="IPF_3.2_Migration_Guide">IPF 3.2 Migration Guide</h2>
 </div> 
 <p>IPF 3.2 comes with some changes that must be considered when upgrading from IPF 3.1 to IPF 3.2.</p> 
 <div class="section"> 
  <h3 id="Environment">Environment</h3> 
  <p>IPF 3.2 requires Java 8. </p> 
 </div> 
 <div class="section"> 
  <h3 id="Dependency_POM">Dependency POM</h3> 
  <p>IPF declares a dependency POM that manages the versions of the major required 3rd party libraries as well as of all IPF modules. In order to align with these versions and minimize conflicts, import the following dependency: </p> 
  <div class="source"> 
   <div class="source"> 
    <pre>    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
        ...
            &lt;dependency&gt;
                &lt;groupId&gt;org.openehealth.ipf&lt;/groupId&gt;
                &lt;artifactId&gt;ipf-dependencies&lt;/artifactId&gt;
                &lt;version&gt;${ipf.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        ...
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="FHIR-based_IHE_transaction_modules_split_up">FHIR-based IHE transaction modules split up</h3> 
  <p>While adding more FHIR-based IHE transactions, it became necessary to split up both the <tt>ipf-platform-camel-ihe-fhir</tt> module and the <tt>ipf-commons-ihe-fhir</tt> module. The Patient-related transactions PIXm and PDQm already existing in IPF 3.1 have been moved into <tt>ipf-platform-camel-ihe-fhir-pixpdq</tt> and <tt>ipf-commons-ihe-fhir-pixpdq</tt>.</p> 
 </div> 
 <div class="section"> 
  <h3 id="HL7v2_Message_Classes">HL7v2 Message Classes</h3> 
  <p>XPID transaction endpoints now create and expect a custom message type <tt>org.openehealth.ipf.commons.ihe.hl7v2.definitions.xpid.v25.message.ADT_A43</tt> instead of the standard <tt>ca.uhn.hl7v2.model.v25.message.ADT_A43</tt>.</p> 
 </div> 
 <div class="section"> 
  <h3 id="XDS_metadata_classes">XDS metadata classes</h3> 
  <p><tt>org.openehealth.ipf.commons.ihe.xds.core.metadata.Telecom</tt> now uses Long values for countryCode, areaCityCode, localNumber and extension instead of Integer values</p> 
 </div> 
 <div class="section"> 
  <h3 id="EhCache">EhCache</h3> 
  <p>EhCache is now an optional dependency. The EhCache implementations <tt>org.openehealth.ipf.platform.camel.ihe.hl7v3.EhcacheHl7v3ContinuationStorage</tt>, <tt>org.openehealth.ipf.platform.camel.ihe.mllp.core.EhcacheInteractiveContinuationStorage</tt>, <tt>org.openehealth.ipf.platform.camel.ihe.mllp.core.EhcacheUnsolicitedFragmentationStorage</tt> and <tt>org.openehealth.ipf.commons.ihe.ws.correlation.EhcacheAsynchonyCorrelator</tt> can only be used if you add a Maven dependency to EhCache to your project.</p> 
 </div> 
 <div class="section"> 
  <h3 id="SecurityEncryption">Security/Encryption</h3> 
  <p>The <tt>ipf-oht-atna</tt> dependency uses more secure default values as before:</p> 
  <ul> 
   <li>The TLS protocol used for Secure Audit Trail is determined by the <tt>jdk.tls.client.protocols</tt> system environment variable that has been introduced with Java 8 (see <a class="externalLink" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/enhancements-8.html">here</a> for details). If not present, the default value is <tt>&quot;TLSv1.2,TLSv1.1,TLSv1&quot;</tt>.</li> 
   <li>As before, the Cipher Suites used for Secure Audit Trail are determined by the <tt>https.ciphersuites</tt> system environment variable, but the default valuer is now <tt>&quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;</tt> (i.e. <tt>&quot;SSL_RSA_WITH_NULL_SHA&quot;</tt> has been removed).</li> 
   <li>The properties set for Secure Audit Trail (see <a href="../ipf-platform-camel-ihe-mllp/atna.html">here</a> for details) will <i>not</i> affect the global system properties anymore, <i>unless</i> the system property <tt>org.openhealthtools.ihe.atna.nodeauth.SetDomainEnvironment</tt> is present.</li> 
  </ul> 
  <p>This also means that the TLS parameters for any outgoing TLS connection as well as incoming MLLPS connections need to be considered separately. All outgoing TLS connections as well as incoming MLLPS connections can now be configured uniformly:</p> 
  <ul> 
   <li>by customizing the system properties listed in the <a class="externalLink" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#InstallationAndCustomization">JSSE documentation</a></li> 
   <li>by providing a <a class="externalLink" href="https://camel.apache.org/camel-configuration-utilities.html">Camel</a> <tt>sslContextParameters</tt> reference in the endpoint URL</li> 
   <li>by directly providing an <tt>sslContext</tt> reference in the endpoint URL</li> 
   <li>by stating <tt>secure=true</tt> in the endpoint URL. In this case, the Camel registry is looked up for a unique bean of type <tt>org.apache.camel.util.jsse.SSLContextParameters</tt>. If none is found, a default SSL Context (controlled by the system properties) is instantiated. If more than one is found, an exception is thrown.</li> 
  </ul> 
 </div> 
 <div class="section"> 
  <h3 id="XUA_Token_Parsing">XUA Token Parsing</h3> 
  <p>The dependencies for parsing the IHE XUA SAML Token from web service requests (for the sake of ATNA auditing) have been isolated in the new new <tt>ipf-commons-ihe-xua</tt> module. When you expect XUA tokens, you need to add the following Maven dependency:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>    &lt;dependency&gt;
        &lt;groupId&gt;org.openehealth.ipf.commons&lt;/groupId&gt;
        &lt;artifactId&gt;ipf-commons-ihe-xua&lt;/artifactId&gt;
    &lt;/dependency&gt;
</pre> 
   </div> 
  </div> 
  <p>See <a class="externalLink" href="https://github.com/oehf/ipf/issues/122">issue #122</a> for details</p> 
 </div> 
 <div class="section"> 
  <h3 id="IHE_Profile_Updates">IHE Profile Updates</h3> 
  <p>IPF 3.2 is compatible with IHE ITI Revision 13 (published on Sep 9, 2016), including changes from the following Change Proposals:</p> 
  <ul> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2017#Ballot_38">Ballot 38</a>: Implemented CP-ITI-949 CP-ITI-961</p> 
    <ul> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2017/CPs/Ballots/ballot_38/CP-ITI-949-02.doc">CP-ITI-949</a>: Clarify Folder.lastUpdateTime</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2017/CPs/Ballots/ballot_38/CP-ITI-961-02.doc">CP-ITI-961</a>: XCDR cleanup</li> 
    </ul></li> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2017#Ballot_37">Ballot 37</a>: Implemented CP-ITI-559 and CP-ITI-810</p> 
    <ul> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance/CPs/Ballots/2017/Ballot_37/CP-ITI-559-04.doc">CP-ITI-559</a>: Parameters is ITI-51 queries</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance/CPs/Ballots/2017/Ballot_37/CP-ITI-810-05.doc">CP-ITI-810</a>: ATNA Audit for ITI-62</li> 
    </ul></li> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2017#Ballot_36">Ballot 36</a>: Implemented CP-ITI-955</p> 
    <ul> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_36/CP-ITI-955-00.doc">CP-ITI-955</a>: Add DocumentEntry type to FindDocumentsByReferenceId</li> 
    </ul></li> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2016#Ballot_35">Ballot 35</a>: No changes were required</p></li> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2016#Ballot_34">Ballot 34</a>: Implemented CP-ITI-767 and CP-ITI-914</p> 
    <ul> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_34/CP-ITI-767-02.doc">CP-ITI-767</a>: Fix errors in CXi datatype and referenceIdList attribute examples</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_34/CP-ITI-914-04.doc">CP-ITI-914</a>: Value of Content-Type HTTP header action parameter</li> 
    </ul></li> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2016#Ballot_33">Ballot 33</a>: Implemented CP-ITI-582, CP-ITI-880, CP-ITI-889, CP-ITI-906 and CP-ITI-918</p> 
    <ul> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_33/CP-ITI-582-06.doc">CP-ITI-582</a>: Metadata Update correction for associations in GetAllQuery</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_33/CP-ITI-880-03.doc">CP-ITI-880</a>: Add new value for Study Instance UID in CXi.5 (Identifier Type Codes)</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_33/CP-ITI-889-08.doc">CP-ITI-889</a>: Clarify Error Code used for ‘RPLC’ or ‘XFRM_RPLC’ Association Validation</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_33/CP-ITI-906-00.doc">CP-ITI-582</a>: ITI-8 MSH message structure - Revert changes introduced in CP-ITI-786</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_33/CP-ITI-918-01.doc">CP-ITI-582</a>: Fix workflowInstanceId specification in Vol 3 CXi datatype definition</li> 
    </ul></li> 
   <li> <p><a class="externalLink" href="http://wiki.ihe.net/index.php/ITI_Change_Proposals_2016#Ballot_32">Ballot 32</a>: Implemented CP-ITI-884 and CP-ITI-885</p> 
    <ul> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_32/CP-ITI-884-00.doc">CP-ITI-582</a>: PIXm changes for DSTU2</li> 
     <li><a class="externalLink" href="ftp://ftp.ihe.net/IT_Infrastructure/TF_Maintenance-2016/CPs/Ballots/ballot_32/CP-ITI-885-00.doc">CP-ITI-880</a>: PDQm changes for DSTU2</li> 
    </ul></li> 
  </ul> 
 </div> 
 <div class="section"> 
  <h3 id="Internal_Restructuring_of_IHE_components">Internal Restructuring of IHE components</h3> 
  <p>Issue <a class="externalLink" href="https://github.com/oehf/ipf/issues/123">#123</a> caused a number of internal refactorings, mostly moving Camel-independent functionality and configuration from the <tt>ipf-platform-camel-*</tt> modules into the corresponding <tt>ipf-commons-*</tt> modules. The majority of the configuration related to IHE transactions (like audit strategies, web service specifications) have been moved into subclasses of <tt>org.openehealth.ipf.commons.ihe.core.InteractionId</tt>.</p> 
  <p>For using existing IPF Camel components, this restructuring remains invisible, however, if you wrote your own Camel components and endpoints based on the abstract base classes provided by IPF, you probably will need to restructure your code correspondingly.</p> 
 </div> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="./" title="Home">Home</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="GitHub project" class="externalLink">GitHub project</a>
						</li>
						<li >
							<a href="changes-report.html" title="Release notes">Release notes</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Download</li>
						<li >
							<a href="https://github.com/oehf/ipf" title="Download" class="externalLink">Download</a>
						</li>
						<li >
							<a href="license.html" title="License">License</a>
						</li>
						<li class="nav-header">Development</li>
						<li >
							<a href="development.html" title="Development">Development</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/issues/" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="https://github.com/oehf/ipf/" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li class="nav-header">Submodules</li>
						<li >
							<a href="../../../../../../ipf-dependencies/index.html" title="ipf-dependencies">ipf-dependencies</a>
						</li>
						<li >
							<a href="ipf-archetypes/index.html" title="ipf-archetypes">ipf-archetypes</a>
						</li>
						<li >
							<a href="ipf-assembly/index.html" title="ipf-assembly">ipf-assembly</a>
						</li>
						<li >
							<a href="ipf-commons/index.html" title="ipf-commons">ipf-commons</a>
						</li>
						<li >
							<a href="ipf-modules/index.html" title="ipf-modules">ipf-modules</a>
						</li>
						<li >
							<a href="ipf-spring-boot/index.html" title="Unnamed - org.openehealth.ipf.boot:ipf-spring-boot:pom:3.2-SNAPSHOT">Unnamed - org.openehealth.ipf.boot:ipf-spring-boot:pom:3.2-SNAPSHOT</a>
						</li>
						<li >
							<a href="ipf-osgi/index.html" title="ipf-osgi">ipf-osgi</a>
						</li>
						<li >
							<a href="ipf-platform-camel/index.html" title="ipf-platform-camel">ipf-platform-camel</a>
						</li>
						<li >
							<a href="ipf-tutorials/index.html" title="ipf-tutorials">ipf-tutorials</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li >
							<a href="ipf-platform-camel-ihe/index.html" title="eHealth Integration Profile">eHealth Integration Profile</a>
						</li>
						<li >
							<a href="ipf-modules-hl7/index.html" title="HL7v2 Message Processing">HL7v2 Message Processing</a>
						</li>
						<li >
							<a href="ipf-commons-ihe-hl7v3/index.html" title="HL7 Message translation">HL7 Message translation</a>
						</li>
						<li >
							<a href="ipf-modules-cda/index.html" title="CDA Support">CDA Support</a>
						</li>
						<li >
							<a href="ipf-platform-camel-core/index.html" title="Camel Groovy layer">Camel Groovy layer</a>
						</li>
						<li >
							<a href="ipf-platform-camel-hl7/index.html" title="Camel HL7 processing">Camel HL7 processing</a>
						</li>
						<li >
							<a href="ipf-platform-camel-cda/index.html" title="Camel CDA processing">Camel CDA processing</a>
						</li>
						<li >
							<a href="ipf-commons-map/index.html" title="Code System Mapping">Code System Mapping</a>
						</li>
						<li >
							<a href="dynamic.html" title="Dynamic Registration of IPF Features">Dynamic Registration of IPF Features</a>
						</li>
						<li >
							<a href="ipf-osgi-karaf/index.html" title="OSGi Support">OSGi Support</a>
						</li>
						<li >
							<a href="ipf-tutorials/index.html" title="Tutorials">Tutorials</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven Reports</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li >
							<a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017 <a href="http://www.openehealth.org/">Open eHealth Foundation</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 3.2-SNAPSHOT. </span><span class="publishDate">Last Published: 2017-03-09. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>
